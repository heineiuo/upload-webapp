/*! index.js v0.0.0 2015-07-20 08:05:48 */
function ajax(a,b,c){return"undefined"==typeof _ajax[a]?void 0:1==arguments.length?_ajax[a]:void _ajax[a].data(b).exec(c)}function assemAjax(a){return{param:function(a){return this._param=a,this},data:function(a){return this._data=_.extend(this._data,a),this},exec:function(b){var c=AJAX_BASE_URL+a[2],d=a[3]||"json";null!=this._param&&(c+="/"+this._param),$.ajax({url:c,type:a[1],data:this._data,dataType:d}).done(function(a){"json"==d&&"undefined"!=typeof a.error?b(a.error,a):b(null,a)}).fail(ajaxFailHandle),this._param=null,this._data={}},_data:{},_param:null}}function ajaxFailHandle(a){var b=0==$("#view-modals").length?$("#view-scope"):$("#view-modals");b.html(JST["modal/ajax-fail"]()),$("#ajax-fail-modal").modal("show"),$(".btn-reload").on("click",function(){location.reload()})}function createCookie(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"}function readCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}function deleteCookie(a){createCookie(a,"",-1)}function filterHTML(a){return a=a.replace(/<\/?[^>]+>/g,""),a=a.replace(/[ | ]*\n/g,"\n"),a=a.replace(/\n[\s| | ]*\r/g,"\n"),a=a.replace(/&nbsp;/gi,"")}function pagenav(a){var b=a.dataLength,c=a.pageNums||10,d=a.$pagenav||$(".pagination"),e=Number(a.targetPage)||1,f={start:1,prev:e-1,active:e,next:e+1,end:Math.ceil(b/c)||1,startClass:"",prevClass:"",activeClass:"active",nextClass:"",endClass:"",prevArrowClass:"",nextArrowClass:"",prevEllipsisClass:"",nextEllipsisClass:""};f.end<=5?(f.prevEllipsisClass="hide",f.nextEllipsisClass="hide",f.prevArrowClass="hide",f.nextArrowClass="hide"):(f.active<=f.start+2&&(f.prevEllipsisClass="hide"),f.active>=f.end-2&&(f.nextEllipsisClass="hide")),f.active==f.start?(f.activeClass="hide",f.startClass="active",f.active==f.end&&(f.endClass="hide")):f.active==f.end&&(f.activeClass="hide",f.endClass="active"),f.prev<=f.start&&(f.prevClass="hide"),f.prev<f.start&&(f.prevArrowClass+=" disabled"),f.next>=f.end&&(f.nextClass="hide"),f.next>f.end&&(f.nextArrowClass+=" disabled"),d.html(JST.pagenav({page:f}))}function pickByRange(a,b,c){for(var d=[],e=b;c>=e&&e<a.length;e++)d.push(a[e]);return d}function prefixZero3(a){return a=String(a),1==a.length?a="00"+a:2==a.length&&(a="0"+a),a}function validator(a,b,c){var d=[],e=null;regs[a]instanceof Array?d=regs[a]:d.push(regs[a]);for(var f=0;f<d.length;f++){var g=d[f].regex,h=d[f].msg;if("function"==typeof g){if(!g(b)){e=h;break}}else if(!g.test(b)){e=h;break}}c(e)}var ENV={ajax_base_url:"/api"},app=purple({spa:!1});_.templateSettings={interpolate:/\{\{(.+?)\}\}/g},$(function(){app.go(location.href)});var apiurl={login:[1,"GET","/login"],register:[1,"GET","/register"]},AJAX_BASE_URL=ENV.development?ENV.ajax_base_url_dev:ENV.ajax_base_url,_ajax={};_.map(apiurl,function(a,b){_ajax[b]=assemAjax(a)});var regs={camera_ip:[{regex:/^((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$/,msg:"请输入正确的IP地址，范围0~255"},{regex:function(a){return"0.0.0.0"!=a},msg:"请输入正确的IP地址"}],camera_presetNum:{regex:/^[1-9]\d*$/,msg:"请输入正整数"},mic_id:{regex:/^[1-9]\d*$/,msg:"请输入正整数"},crestron_port:{regex:/^[1-9]$|(^[1-9][0-9]$)|(^[1-9][0-9][0-9]$)|(^[1-9][0-9][0-9][0-9]$)|(^[1-6][0-5][0-5][0-3][0-5]$)/,msg:"请输入1~65535之间的整数"},camera_name:{regex:function(a){return 0!=$.trim(a).length},msg:"摄像头名称不能为空"},mic_name:{regex:function(a){return 0!=$.trim(a).length},msg:"麦克风名称不能为空"}},index={};index.renderIndex=function(a,b,c){$("#view-scope").html(JST["layout-main"]()),c()};var user={};user.renderRegister=function(a,b){$("#view-scope").html(JST["layout-user"]()),$("#user-content").html(JST["user/register"]()),$("#submitReg").on("click",function(){ajax("register").data(data).exec(function(a,b){})})},app.route("/").get(index.renderIndex),app.route("/register").get(user.renderRegister);